<!DOCTYPE HTML>
<html>
    <head>
        <link rel="Stylesheet" type="text/css" href="/wiki/static/css/style.css">
        <link rel="Stylesheet" type="text/css" href="/wiki/static/css/tango.css">
        <link rel="Stylesheet" type="text/css" href="/wiki/static/plugin/tipuesearch/css/tipuesearch.css">
        <link rel="stylesheet" href="/wiki/static/plugin/tipuesearch/css/normalize.css">
        <link rel="stylesheet" href="/wiki/static/plugin/tipuesearch/css/tipuesearch.css">
        <link rel="shortcut icon" href="/wiki/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/wiki/favicon.ico" type="image/x-icon">
        <title>python 拾遗 - tracholar's personal knowledge wiki</title>
        <meta name="keywords" content="technology, machine learning, data mining, economics, accounting"/>
        <meta name="description" content="A wiki website of tracholar when I learned new knowledgy and technics."/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width" />

        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$(',')$'], ['\\(','\\)']]}
        });
        </script>
        <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script src="https://code.jquery.com/jquery-2.2.4.min.js"
            integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
            crossorigin="anonymous"></script>

        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-78529611-1', 'auto');
          ga('send', 'pageview');

        </script>
    </head>

    <body>
        <div id="container">
            
<div id="header">
  <div id="post-nav"><a href="/wiki/">Home</a>&nbsp;»&nbsp;<a href="/wiki/#python">python</a>&nbsp;»&nbsp;python 拾遗</div>
</div>
<div class="clearfix"></div>
<div id="title">python 拾遗</div>
<div id="content">
  <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#_1">基本语法相关</a></li>
<li><a href="#_2">函数</a></li>
<li><a href="#_3">类</a></li>
<li><a href="#_4">装饰器</a></li>
<li><a href="#with">上下文管理器 with</a></li>
<li><a href="#_5">迭代器相关函数</a></li>
<li><a href="#_6">各种坑</a></li>
<li><a href="#_7">工具函数</a></li>
</ul>
</div>
<h2 id="_1">基本语法相关</h2>
<ul>
<li><code>*args</code>，将列表<code>args</code>展开为参数列表，<code>**kwargs</code>，将字典<code>kwargs</code>展开成kv形式的参数列表。</li>
</ul>
<p>参考 <a href="https://stackoverflow.com/questions/2921847/what-does-the-star-operator-mean-in-python">https://stackoverflow.com/questions/2921847/what-does-the-star-operator-mean-in-python</a><br />
和 <a href="https://docs.python.org/3/tutorial/controlflow.html#unpacking-argument-lists">https://docs.python.org/3/tutorial/controlflow.html#unpacking-argument-lists</a></p>
<ul>
<li>整数除法，在python2.x中<code>/</code>代表整数除法（除非左右操作数有一个是浮点数），而在python3.x中，代表浮点数除法，python3.x用<code>//</code>代表整数除法。</li>
<li>反射函数，<code>type()</code>，<code>isinstance()</code>，<code>hasattr()</code>，<code>setattr()</code> 以及属性<code>__class__</code></li>
<li>Mixin：python通过多重继承实现组合模式。sklearn中很多基础类使用这种模式实现的。<a href="https://github.com/scikit-learn/scikit-learn/blob/51a765a/sklearn/base.py#L281">https://github.com/scikit-learn/scikit-learn/blob/51a765a/sklearn/base.py#L281</a></li>
</ul>
<h2 id="_2">函数</h2>
<p>参考：<a href="https://stackoverflow.com/documentation/python/228/functions">https://stackoverflow.com/documentation/python/228/functions</a></p>
<ul>
<li>任意参数：<code>*args, **kwargs</code></li>
</ul>
<div class="hlcode"><pre><span></span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="c1"># args will be a tuple containing all values that are passed in</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>字符串函数拾遗：除了<code>upper, lower</code> 之外还有：<a href="https://stackoverflow.com/documentation/python/278/string-methods">https://stackoverflow.com/documentation/python/278/string-methods</a></p>
<ul>
<li><code>capitalize</code> 将第一个变为大写，其他的变为小写！</li>
<li><code>title</code> 将每个单词第一个字母变为大写，其他的为小写！</li>
<li>
<p><code>casefold</code> @since(3.3) 小写转换的unicode字符版！希腊字母也可以转</p>
</li>
<li>
<p><code>translate</code> 按照替换表进行字母替换</p>
</li>
<li><code>format</code> 格式化</li>
<li><code>split, rsplit</code> 当指定 <code>maxsplit</code> 参数的时候，有区别</li>
<li>string 模块常量，要使用<code>import string</code>导入：<code>string.ascii_letters</code> 字母表, <code>string.ascii_lowercase, string.ascii_uppercase, string.digits, string.hexdigits, string.octaldigits, string.punctuation, string.whitespace, string.printable</code></li>
<li>unicodedata, 一个有趣的模块</li>
<li><code>str.count(sub[, start[, end]])</code> 统计出现的次数</li>
<li><code>str.replace(old, new[, count])</code> 简单替换，<code>re.sub</code>基于正则式替换</li>
<li><code>str.isupper(), str.islower() and str.istitle()</code></li>
<li><code>str.ljust and str.rjust</code> 字符串对齐</li>
<li><code>'hello'[::-1]</code> 字符串反转</li>
<li><code>str.strip([chars]), str.rstrip([chars]) and str.lstrip([chars])</code> 去掉空白字符</li>
<li><code>"foo" in my_str</code> 字符串包含检查</li>
<li><code>str.startswith() and str.endswith()</code> 字符串首尾</li>
<li><code>encode, decode</code> 字符串和unicode字符串之间的转换</li>
<li>共同前缀！</li>
</ul>
</li>
</ul>
<div class="hlcode"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">mylist</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&amp;abcd&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;abbe&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;ab&quot;</span><span class="p">]</span>
<span class="k">print</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">commonprefix</span><span class="p">(</span><span class="n">mylist</span><span class="p">))</span>
</pre></div>


<h2 id="_3">类</h2>
<p>参考 <a href="https://stackoverflow.com/documentation/python/419/classes">https://stackoverflow.com/documentation/python/419/classes</a></p>
<ul>
<li>Bound, unbound, and static methods</li>
</ul>
<p>Bound 方法就是通过类的实例访问的方法（instancemethod）， unbound 方法就是通过类本身访问的动态方法（Python3.x 已废弃)</p>
<div class="hlcode"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="n">a</span><span class="o">.</span><span class="n">f</span>
<span class="c1"># &lt;bound method A.f of &lt;__main__.A object at ...&gt;&gt;</span>
<span class="n">a</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># 4</span>

<span class="c1"># Note: the bound method object a.f is recreated *every time* you call it:</span>
<span class="n">a</span><span class="o">.</span><span class="n">f</span> <span class="ow">is</span> <span class="n">a</span><span class="o">.</span><span class="n">f</span>  <span class="c1"># False</span>
<span class="c1"># As a performance optimization you can store the bound method in the object&#39;s</span>
<span class="c1"># __dict__, in which case the method object will remain fixed:</span>
<span class="n">a</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">f</span>
<span class="n">a</span><span class="o">.</span><span class="n">f</span> <span class="ow">is</span> <span class="n">a</span><span class="o">.</span><span class="n">f</span>  <span class="c1"># True</span>
</pre></div>


<ul>
<li>@classmethod 装饰器，第一个参数代表类，类方法，既可以通过类调用，也可以通过类的实例调用</li>
<li>@staticmethod ，只能通过类调用</li>
<li>
<p>无装饰器， 只能通过实例调用</p>
</li>
<li>
<p>类的继承：从3.x开始，<code>super</code> 不再需要传入参数了！</p>
</li>
</ul>
<div class="hlcode"><pre><span></span><span class="k">class</span> <span class="nc">Square</span><span class="p">(</span><span class="n">Rectangle</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="c1"># call parent constructor, w and h are both s</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Rectangle</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">s</span>
</pre></div>


<ul>
<li>抽象类：<code>abc</code>模块，需要制定<code>__metaclass__</code>变量为<code>ABCMeta</code>，子类需要注册！</li>
</ul>
<div class="hlcode"><pre><span></span><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABCMeta</span>

<span class="k">class</span> <span class="nc">AbstractClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="c1"># the metaclass attribute must always be set as a class variable</span>
    <span class="vm">__metaclass__</span> <span class="o">=</span> <span class="n">ABCMeta</span>

   <span class="c1"># the abstractmethod decorator registers this method as undefined</span>
   <span class="nd">@abstractmethod</span>
   <span class="k">def</span> <span class="nf">virtual_method_subclasses_must_define</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="c1"># Can be left completely blank, or a base implementation can be provided</span>
       <span class="c1"># Note that ordinarily a blank interpretation implicitly returns `None`,</span>
       <span class="c1"># but by registering, this behaviour is no longer enforced.</span>

<span class="k">class</span> <span class="nc">Subclass</span><span class="p">:</span>
   <span class="k">def</span> <span class="nf">virtual_method_subclasses_must_define</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="k">return</span>

<span class="c1"># registration is mandatory to truly create an abstract class</span>
<span class="n">AbstractClass</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">SubClass</span><span class="p">)</span>
</pre></div>


<ul>
<li>多重继承：<code>class FooBar(Foo, Bar)</code></li>
<li>私有变量：<code>_non_public</code> 通过添加一个下划线实现！（哈哈！）</li>
<li>属性方法：可以将属性设置为只读，不提供<code>setter</code>方法</li>
</ul>
<div class="hlcode"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">_my_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">my_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_my_string</span>

    <span class="nd">@my_string.setter</span>
    <span class="k">def</span> <span class="nf">my_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_my_string</span> <span class="o">=</span> <span class="n">new_value</span>

    <span class="nd">@my_string.deleter</span>
    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_my_string</span>
</pre></div>


<h2 id="_4">装饰器</h2>
<p>任何传入一个函数，返回一个函数的函数都可以作为装饰器！(貌似无效！py2.7)</p>
<div class="hlcode"><pre><span></span><span class="k">def</span> <span class="nf">super_secret_function</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span>

<span class="nd">@super_secret_function</span>
<span class="k">def</span> <span class="nf">my_function</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;This is my secret function.&quot;</span><span class="p">)</span>
</pre></div>


<p>这里<code>@</code> 相当于实现 <code>my_function = super_secret_function(my_function)</code></p>
<p>装饰器类：<code>__call__</code> 方法进行装饰。如果需要装饰成员方法，需要指定<code>__get__</code>方法！<br />
装饰器可以使用参数，只要在函数内部定义一个类，然后返回即可。</p>
<div class="hlcode"><pre><span></span><span class="k">class</span> <span class="nc">Decorator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simple decorator class.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Before the function call.&#39;</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;After the function call.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>

<span class="nd">@Decorator</span>
<span class="k">def</span> <span class="nf">testfunc</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Inside the function.&#39;</span><span class="p">)</span>

<span class="n">testfunc</span><span class="p">()</span>
<span class="c1"># Before the function call.</span>
<span class="c1"># Inside the function.</span>
<span class="c1"># After the function call.</span>
</pre></div>


<h2 id="with">上下文管理器 <code>with</code></h2>
<ul>
<li>把文件当做上下文，上下文结束的时候会自动关闭文件！</li>
<li>自己的上下文管理器需要实现两个方法 <code>__enter__() and __exit__()</code></li>
</ul>
<h2 id="_5">迭代器相关函数</h2>
<ul>
<li><code>enumerate(iter)</code> 返回<code>(idx, value)</code>的迭代器，可以应用在需要使用index的时候。</li>
<li><code>(x for x ... )</code> 圆括号生成迭代器的一个语法糖。</li>
</ul>
<h2 id="_6">各种坑</h2>
<ul>
<li>不要用可变对象作为函数默认值。字典,集合,列表等等对象是不适合作为函数默认值的.<br />
  因为这个默认值是在函数建立的时候就生成了, 每次调用都是用了这个对象的”缓存”.</li>
</ul>
<div class="hlcode"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="k">def</span> <span class="nf">append_to_list</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">def_list</span><span class="o">=</span><span class="p">[]):</span>
   <span class="o">...</span><span class="p">:</span>         <span class="n">def_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span>         <span class="k">return</span> <span class="n">def_list</span>
   <span class="o">...</span><span class="p">:</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">my_list</span> <span class="o">=</span> <span class="n">append_to_list</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">my_list</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">my_other_list</span> <span class="o">=</span> <span class="n">append_to_list</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">my_other_list</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="c1"># 看到了吧，其实我们本来只想生成[2] 但是却把第一次运行的效果页带了进来</span>
</pre></div>


<ul>
<li>生成器不保留迭代过后的结果</li>
</ul>
<div class="hlcode"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="n">gen</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="mi">2</span> <span class="ow">in</span> <span class="n">gen</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="bp">True</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="mi">3</span> <span class="ow">in</span> <span class="n">gen</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="bp">True</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="mi">1</span> <span class="ow">in</span> <span class="n">gen</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="bp">False</span> <span class="c1"># 1为什么不在gen里面了? 因为调用1-&gt;2,这个时候1已经不在迭代器里面了,被按需生成过了</span>
</pre></div>


<ul>
<li>在循环中修改列表项，例如在循环中删除某个元素导致index紊乱</li>
</ul>
<div class="hlcode"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">44</span><span class="p">]:</span> <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">45</span><span class="p">]:</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
   <span class="o">....</span><span class="p">:</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
   <span class="o">....</span><span class="p">:</span>         <span class="n">a</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
   <span class="o">....</span><span class="p">:</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">46</span><span class="p">]:</span> <span class="n">a</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">46</span><span class="p">]:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="c1"># 没有问题</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">50</span><span class="p">]:</span> <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">51</span><span class="p">]:</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">b</span><span class="p">:</span>
   <span class="o">....</span><span class="p">:</span>      <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
   <span class="o">....</span><span class="p">:</span>          <span class="n">b</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
   <span class="o">....</span><span class="p">:</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">52</span><span class="p">]:</span> <span class="n">b</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">52</span><span class="p">]:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="c1"># 本来我想要的结果应该是去除偶数的列表</span>
</pre></div>


<ul>
<li>IndexError，</li>
</ul>
<div class="hlcode"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">55</span><span class="p">]:</span> <span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">56</span><span class="p">]:</span> <span class="n">my_list</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="c1"># 根本没有这个元素</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">57</span><span class="p">]:</span> <span class="n">my_list</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span> <span class="c1"># 这个是可以的</span>
</pre></div>


<ul>
<li>全局变量和局部变量重名问题</li>
</ul>
<div class="hlcode"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">58</span><span class="p">]:</span> <span class="k">def</span> <span class="nf">my_func</span><span class="p">():</span>
   <span class="o">....</span><span class="p">:</span>         <span class="k">print</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="c1"># 我可以先调用一个未定义的变量</span>
   <span class="o">....</span><span class="p">:</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">59</span><span class="p">]:</span> <span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;global&#39;</span> <span class="c1"># 后赋值</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">60</span><span class="p">]:</span> <span class="n">my_func</span><span class="p">()</span> <span class="c1"># 反正只要调用函数时候变量被定义了就可以了</span>
<span class="k">global</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">61</span><span class="p">]:</span> <span class="k">def</span> <span class="nf">my_func</span><span class="p">():</span>
   <span class="o">....</span><span class="p">:</span>     <span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;locally changed&#39;</span>
   <span class="o">....</span><span class="p">:</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">62</span><span class="p">]:</span> <span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;global&#39;</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">63</span><span class="p">]:</span> <span class="n">my_func</span><span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">64</span><span class="p">]:</span> <span class="k">print</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>

<span class="k">global</span> <span class="c1"># 局部变量没有影响到全局变量</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">65</span><span class="p">]:</span> <span class="k">def</span> <span class="nf">my_func</span><span class="p">():</span>
   <span class="o">....</span><span class="p">:</span>         <span class="k">print</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="c1"># 虽然你全局设置这个变量, 但是局部变量有同名的, python以为你忘了定义本地变量了</span>
   <span class="o">....</span><span class="p">:</span>         <span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;locally changed&#39;</span>
   <span class="o">....</span><span class="p">:</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">66</span><span class="p">]:</span> <span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;global&#39;</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">67</span><span class="p">]:</span> <span class="n">my_func</span><span class="p">()</span>
<span class="o">---------------------------------------------------------------------------</span>
<span class="ne">UnboundLocalError</span>                         <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">67</span><span class="o">-</span><span class="n">d82eda95de40</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">my_func</span><span class="p">()</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">65</span><span class="o">-</span><span class="mi">0</span><span class="n">ad11d690936</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="n">my_func</span><span class="p">()</span>
      <span class="mi">1</span> <span class="k">def</span> <span class="nf">my_func</span><span class="p">():</span>
<span class="o">----&gt;</span> <span class="mi">2</span>         <span class="k">print</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
      <span class="mi">3</span>         <span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;locally changed&#39;</span>
      <span class="mi">4</span>

<span class="ne">UnboundLocalError</span><span class="p">:</span> <span class="n">local</span> <span class="n">variable</span> <span class="s1">&#39;var&#39;</span> <span class="n">referenced</span> <span class="n">before</span> <span class="n">assignment</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">68</span><span class="p">]:</span> <span class="k">def</span> <span class="nf">my_func</span><span class="p">():</span>
   <span class="o">....</span><span class="p">:</span>         <span class="k">global</span> <span class="n">var</span> <span class="c1"># 这个时候得加全局了</span>
   <span class="o">....</span><span class="p">:</span>         <span class="k">print</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="c1"># 这样就能正常使用</span>
   <span class="o">....</span><span class="p">:</span>         <span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;locally changed&#39;</span>
   <span class="o">....</span><span class="p">:</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">69</span><span class="p">]:</span> <span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;global&#39;</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">70</span><span class="p">]:</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">70</span><span class="p">]:</span> <span class="n">my_func</span><span class="p">()</span>
<span class="k">global</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">71</span><span class="p">]:</span> <span class="k">print</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
<span class="n">locally</span> <span class="n">changed</span> <span class="c1"># 但是使用了global就改变了全局变量</span>
</pre></div>


<ul>
<li><code>is</code> 和 <code>==</code> 前者比较是否是同一个对象，后者比较值是否相等</li>
</ul>
<h2 id="_7">工具函数</h2>
<ul>
<li>获取对象成员，<code>getmembers</code>, <code>dir</code>等函数</li>
</ul>
<div class="hlcode"><pre><span></span><span class="kn">from</span> <span class="nn">inspect</span> <span class="kn">import</span> <span class="n">getmembers</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="p">(</span><span class="n">getmembers</span><span class="p">(</span><span class="nb">object</span><span class="p">)):</span>
    <span class="k">print</span> <span class="n">k</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">v</span>
</pre></div>
</div>
<div id="content-footer">created in <span class="create-date date"> 2016-07-10 </span></div>
<div id="comments"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script type="text/javascript">
const gitment = new Gitment({
  id: location.pathname,
  title: 'python 拾遗',
  owner: 'tracholar',
  repo: 'wiki',
  oauth: {
    client_id: '0cc0476e504b5e70ae7c',
    client_secret: 'ab98e39ef79469040057eba9c6b2b543b84c72ee',
  },
  // ...
  // For more available options, check out the documentation below
})

gitment.render('comments')
// or
// gitment.render(document.getElementById('comments'))
// or
// document.body.appendChild(gitment.render())
</script>

        </div>
        <div id="footer">
            <span>
                Copyright © 2018 tracholar.
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
                Fork me in <a href="https://github.com/tracholar/wiki" target="_blank"> github </a>.
            </span>
        </div>
        

        <script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?df74779713027375e7b79302fb72d7b0";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
        </script>


        <script src="/wiki/tipuesearch_content.js"></script>
        <script src="/wiki/static/plugin/tipuesearch/tipuesearch_set.js"></script>
        <script src="/wiki/static/plugin/tipuesearch/tipuesearch.min.js"></script>
    </body>
</html>