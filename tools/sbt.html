<!DOCTYPE HTML>
<html>
    <head>
        <link rel="Stylesheet" type="text/css" href="/wiki/static/css/style.css">
        <link rel="Stylesheet" type="text/css" href="/wiki/static/css/tango.css">
        <link rel="shortcut icon" href="/wiki/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/wiki/favicon.ico" type="image/x-icon">
        <title>SBT - scala构建工具 - tracholar's personal knowledge wiki</title>
        <meta name="keywords" content="technology, machine learning, data mining, economics, accounting"/>
        <meta name="description" content="A wiki website of tracholar when I learned new knowledgy and technics."/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width" />

        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$(',')$'], ['\\(','\\)']]}
        });
        </script>
        <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-78529611-1', 'auto');
          ga('send', 'pageview');

        </script>
    </head>

    <body>
        <div id="container">
            
<div id="header">
  <div id="post-nav"><a href="/wiki/">Home</a>&nbsp;»&nbsp;<a href="/wiki/#tools">tools</a>&nbsp;»&nbsp;SBT - scala构建工具</div>
</div>
<div class="clearfix"></div>
<div id="title">SBT - scala构建工具</div>
<div id="content">
  <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#_1">关于</a></li>
<li><a href="#_2">构建项目</a><ul>
<li><a href="#_3">从单个文件构建</a></li>
<li><a href="#buildsbt">构建文件build.sbt</a></li>
<li><a href="#_4">目录结构</a></li>
</ul>
</li>
<li><a href="#_5">两种构建模式</a></li>
</ul>
</div>
<h2 id="_1">关于</h2>
<p>sbt是scala的交互式构建工具，类似于java的maven。</p>
<h2 id="_2">构建项目</h2>
<h3 id="_3">从单个文件构建</h3>
<p>最简单的方式是从只包含一个scala源文件的目录构建项目。
例如在目录<code>helloword</code>创建一个<code>HW.scala</code>文件</p>
<div class="hlcode"><pre><span class="k">object</span> <span class="nc">Hi</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="k">=</span> <span class="n">println</span><span class="o">(</span><span class="s">&quot;Hi!&quot;</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>


<p>然后运行<code>sbt</code>，和<code>run</code>，或者直接运行<code>sbt run</code>命令。</p>
<p>sbt自动寻找下列目录</p>
<ul>
<li>Sources in the base directory</li>
<li>Sources in src/main/scala or src/main/java</li>
<li>Tests in src/test/scala or src/test/java</li>
<li>Data files in src/main/resources or src/test/resources</li>
<li>jars in lib</li>
</ul>
<h3 id="buildsbt">构建文件<code>build.sbt</code></h3>
<p>位于项目根目录，一个简单的构建文件如下</p>
<div class="hlcode"><pre><span class="k">lazy</span> <span class="k">val</span> <span class="n">root</span> <span class="k">=</span> <span class="o">(</span><span class="n">project</span> <span class="n">in</span> <span class="n">file</span><span class="o">(</span><span class="s">&quot;.&quot;</span><span class="o">)).</span>
  <span class="n">settings</span><span class="o">(</span>
    <span class="n">name</span> <span class="o">:=</span> <span class="s">&quot;hello&quot;</span><span class="o">,</span>
    <span class="n">version</span> <span class="o">:=</span> <span class="s">&quot;1.0&quot;</span><span class="o">,</span>
    <span class="n">scalaVersion</span> <span class="o">:=</span> <span class="s">&quot;2.11.7&quot;</span>
  <span class="o">)</span>
</pre></div>


<p>如果是要打包到jar文件，name和version是必须的。</p>
<p>添加依赖</p>
<div class="hlcode"><pre><span class="k">val</span> <span class="n">derby</span> <span class="k">=</span> <span class="s">&quot;org.apache.derby&quot;</span> <span class="o">%</span> <span class="s">&quot;derby&quot;</span> <span class="o">%</span> <span class="s">&quot;10.4.1.3&quot;</span>

<span class="k">lazy</span> <span class="k">val</span> <span class="n">commonSettings</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
  <span class="n">organization</span> <span class="o">:=</span> <span class="s">&quot;com.example&quot;</span><span class="o">,</span>
  <span class="n">version</span> <span class="o">:=</span> <span class="s">&quot;0.1.0&quot;</span><span class="o">,</span>
  <span class="n">scalaVersion</span> <span class="o">:=</span> <span class="s">&quot;2.11.7&quot;</span>
<span class="o">)</span>

<span class="k">lazy</span> <span class="k">val</span> <span class="n">root</span> <span class="k">=</span> <span class="o">(</span><span class="n">project</span> <span class="n">in</span> <span class="n">file</span><span class="o">(</span><span class="s">&quot;.&quot;</span><span class="o">)).</span>
  <span class="n">settings</span><span class="o">(</span><span class="n">commonSettings</span><span class="k">:</span> <span class="k">_</span><span class="kt">*</span><span class="o">).</span>
  <span class="n">settings</span><span class="o">(</span>
    <span class="n">name</span> <span class="o">:=</span> <span class="s">&quot;hello&quot;</span><span class="o">,</span>
    <span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="n">derby</span>
  <span class="o">)</span>
</pre></div>


<p>依赖库的写法是：</p>
<div class="hlcode"><pre><span class="n">groupID</span> <span class="o">%</span> <span class="n">artifactID</span> <span class="o">%</span> <span class="n">revision</span>
</pre></div>


<p>如果将依赖的库放在lib目录下，就不需要添加该依赖。</p>
<h3 id="_4">目录结构</h3>
<ul>
<li>源码
sbt的源码目录结构与maven一样。</li>
</ul>
<div class="hlcode"><pre><span class="n">src</span><span class="o">/</span>
  <span class="n">main</span><span class="o">/</span>
    <span class="n">resources</span><span class="o">/</span>
       <span class="o">&lt;</span><span class="n">files</span> <span class="n">to</span> <span class="n">include</span> <span class="n">in</span> <span class="n">main</span> <span class="n">jar</span> <span class="n">here</span><span class="o">&gt;</span>
    <span class="n">scala</span><span class="o">/</span>
       <span class="o">&lt;</span><span class="n">main</span> <span class="n">Scala</span> <span class="n">sources</span><span class="o">&gt;</span>
    <span class="n">java</span><span class="o">/</span>
       <span class="o">&lt;</span><span class="n">main</span> <span class="n">Java</span> <span class="n">sources</span><span class="o">&gt;</span>
  <span class="n">test</span><span class="o">/</span>
    <span class="n">resources</span>
       <span class="o">&lt;</span><span class="n">files</span> <span class="n">to</span> <span class="n">include</span> <span class="n">in</span> <span class="n">test</span> <span class="n">jar</span> <span class="n">here</span><span class="o">&gt;</span>
    <span class="n">scala</span><span class="o">/</span>
       <span class="o">&lt;</span><span class="n">test</span> <span class="n">Scala</span> <span class="n">sources</span><span class="o">&gt;</span>
    <span class="n">java</span><span class="o">/</span>
       <span class="o">&lt;</span><span class="n">test</span> <span class="n">Java</span> <span class="n">sources</span><span class="o">&gt;</span>
</pre></div>


<ul>
<li>
<p>构建定义文件
包含根目录的<code>build.sbt</code>，其他构建文件放在project目录下。</p>
</li>
<li>
<p>构建输出文件目录是<code>target/</code>，在<code>.gitignore</code>中应该排除该目录</p>
</li>
</ul>
<h2 id="_5">两种构建模式</h2>
<ul>
<li>交互式模式，输入<code>sbt</code>命令后面不跟参数，然后进入交互式环境，然后运行命令构建。</li>
<li>批处理模式，跟参数罗。<code>sbt clean compile "testOnly TestA TestB"</code></li>
<li>常见命令，更多参考</li>
</ul>
<div class="hlcode"><pre><span class="n">clean</span>   <span class="err">删除所有生成的文件</span> <span class="err">（在</span> <span class="n">target</span> <span class="err">目录下）。</span>
<span class="n">compile</span> <span class="err">编译源文件（在</span> <span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">scala</span> <span class="err">和</span> <span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span> <span class="err">目录下）。</span>
<span class="n">test</span>    <span class="err">编译和运行所有测试。</span>
<span class="n">console</span> <span class="err">进入到一个包含所有编译的文件和所有依赖的</span> <span class="n">classpath</span> <span class="err">的</span> <span class="n">Scala</span> <span class="err">解析器。输入</span> <span class="o">:</span><span class="n">quit</span><span class="err">，</span> <span class="n">Ctrl</span><span class="o">+</span><span class="n">D</span> <span class="err">（</span><span class="n">Unix</span><span class="err">），或者</span> <span class="n">Ctrl</span><span class="o">+</span><span class="n">Z</span> <span class="err">（</span><span class="n">Windows</span><span class="err">）</span> <span class="err">返回到</span> <span class="n">sbt</span><span class="err">。</span>
<span class="n">run</span> <span class="o">&lt;</span><span class="err">参数</span><span class="o">&gt;*</span>   <span class="err">在和</span> <span class="n">sbt</span> <span class="err">所处的同一个虚拟机上执行项目的</span> <span class="n">main</span> <span class="n">class</span><span class="err">。</span>
<span class="n">package</span> <span class="err">将</span> <span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">resources</span> <span class="err">下的文件和</span> <span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">scala</span> <span class="err">以及</span> <span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span> <span class="err">中编译出来的</span> <span class="n">class</span> <span class="err">文件打包成一个</span> <span class="n">jar</span> <span class="err">文件。</span>
<span class="n">help</span> <span class="o">&lt;</span><span class="err">命令</span><span class="o">&gt;</span>   <span class="err">显示指定的命令的详细帮助信息。如果没有指定命令，会显示所有命令的简介。</span>
<span class="n">reload</span>  <span class="err">重新加载构建定义（</span><span class="n">build</span><span class="p">.</span><span class="n">sbt</span><span class="err">，</span> <span class="n">project</span><span class="o">/*</span><span class="p">.</span><span class="n">scala</span><span class="err">，</span> <span class="n">project</span><span class="o">/*</span><span class="p">.</span><span class="n">sbt</span> <span class="err">这些文件中定义的内容</span><span class="p">)</span><span class="err">。在修改了构建定义文件之后需要重新加载。</span>
</pre></div>
</div>
<div id="content-footer">created in <span class="create-date date"> 2016-07-11 </span></div>

        </div>
        <div id="footer">
            <span>
                Copyright © 2016 tracholar.
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
                Fork me in <a href="https://github.com/tracholar/wiki" target="_blank"> github </a>.
            </span>
        </div>
        
    </body>
</html>