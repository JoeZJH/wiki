<!DOCTYPE HTML>
<html>
    <head>
        <link rel="Stylesheet" type="text/css" href="/wiki/static/css/style.css">
        <link rel="Stylesheet" type="text/css" href="/wiki/static/css/tango.css">
        <link rel="shortcut icon" href="/wiki/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/wiki/favicon.ico" type="image/x-icon">
        <title>Linux 基础知识 - tracholar's personal knowledge wiki</title>
        <meta name="keywords" content="technology, machine learning, data mining, economics, accounting"/>
        <meta name="description" content="A wiki website of tracholar when I learned new knowledgy and technics."/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width" />

        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$(',')$'], ['\\(','\\)']]}
        });
        </script>
        <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-78529611-1', 'auto');
          ga('send', 'pageview');

        </script>
    </head>

    <body>
        <div id="container">
            
<div id="header">
  <div id="post-nav"><a href="/wiki/">Home</a>&nbsp;»&nbsp;<a href="/wiki/#tools">tools</a>&nbsp;»&nbsp;Linux 基础知识</div>
</div>
<div class="clearfix"></div>
<div id="title">Linux 基础知识</div>
<div id="content">
  <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#_1">关于</a></li>
<li><a href="#_2">常用命令集合</a><ul>
<li><a href="#_3">文件系统相关</a></li>
<li><a href="#_4">权限相关</a></li>
<li><a href="#_5">操作系统相关</a></li>
<li><a href="#_6">字符串工具</a></li>
<li><a href="#sort">sort 命令</a></li>
</ul>
</li>
<li><a href="#vim">VIM</a><ul>
<li><a href="#_7">三种模式</a></li>
<li><a href="#_8">移动光标</a></li>
<li><a href="#_9">参考</a></li>
</ul>
</li>
</ul>
</div>
<h2 id="_1">关于</h2>
<p>作为一个合格的工程师，怎能不懂Linux，所以学习记录一些知识点。</p>
<h2 id="_2">常用命令集合</h2>
<h3 id="_3">文件系统相关</h3>
<ul>
<li>重定向：<code>2&gt;&amp;1</code>表示将stderr重定向到stdout，<code>2&gt;/dev/null</code>表示重定向stderr到空洞，也就是不打印出stderr。
  后面这个在运行hadoop和spark的时候有用。也可以将stdout和stderr重定向到不同文件，例如：        </li>
</ul>
<div class="hlcode"><pre>some-cmd 1&gt;stdout.txt 2&gt;stderr.txt
</pre></div>


<h3 id="_4">权限相关</h3>
<ul>
<li><code>sudo</code>:    <br />
在<code>sudo</code>出现之前，使用<code>su</code>命令提升权限，缺点是必须知道超级用户的密码。<code>sudo</code>可以将用户的名字、可以使用的特殊命令、按照那种用户组执行等信息保存在
文件中（通常是<code>/etc/sudoers</code>）
sudo [-bhHpV][-s ][-u &lt;用户&gt;][指令]
或
sudo [-klv]
参数[编辑]
　　-b 　在后台执行指令。
　　-h 　显示帮助。
　　-H 　将HOME环境变量设为新身份的HOME环境变量。
　　-k 　结束密码的有效期限，也就是下次再执行sudo时便需要输入密码。
　　-l 　列出目前用户可执行与无法执行的指令。
　　-p 　改变询问密码的提示符号。
　　-s 　执行指定的shell。
　　-u &lt;用户&gt; 　以指定的用户作为新的身份。若不加上此参数，则预设以root作为新的身份。
　　-v 　延长密码有效期限5分钟。
　　-V 　显示版本信息。
   -S   从标准输入流替代终端来获取密码</li>
</ul>
<h3 id="_5">操作系统相关</h3>
<p>后台可靠运行的几种方法：        <br />
- 后台运行加一个<code>&amp;</code>即可，例如<code>sleep 100 &amp;</code>，只能一直保持会话，如果shell会话关了，这个子进程也会关掉。   <br />
- nohup 方式：  <br />
我们知道，当用户注销（logout）或者网络断开时，终端会收到 HUP（hangup）信号从而关闭其所有子进程。因此，我们的解决办法就有两种途径：要么让进程忽略 HUP 信号，要么让进程运行在新的会话里从而成为不属于此终端的子进程。
只需在要处理的命令前加上 nohup 即可，标准输出和标准错误缺省会被重定向到 nohup.out 文件中。一般我们可在结尾加上"&amp;"来将命令同时放入后台运行，也可用"&gt;filename 2&gt;&amp;1"来更改缺省的重定向文件名。         <br />
- setsid 方式：  <br />
nohup 无疑能通过忽略 HUP 信号来使我们的进程避免中途被中断，但如果我们换个角度思考，如果我们的进程不属于接受 HUP 信号的终端的子进程，那么自然也就不会受到 HUP 信号的影响了。setsid 就能帮助我们做到这一点。             <br />
使用的时候，也只需在要处理的命令前加上 setsid 即可。
- 当我们将"&amp;"也放入“()”内之后，我们就会发现所提交的作业并不在作业列表中，也就是说，是无法通过jobs来查看的。让我们来看看为什么这样就能躲过 HUP 信号的影响吧。                     </p>
<div class="hlcode"><pre>subshell 示例
<span class="o">[</span>root@pvcent107 ~<span class="o">]</span><span class="c"># (ping www.ibm.com &amp;)</span>
<span class="o">[</span>root@pvcent107 ~<span class="o">]</span><span class="c"># ps -ef |grep www.ibm.com</span>
root     16270     1  0 14:13 pts/4    00:00:00 ping www.ibm.com
root     16278 15362  0 14:13 pts/4    00:00:00 grep www.ibm.com
<span class="o">[</span>root@pvcent107 ~<span class="o">]</span><span class="c">#</span>
</pre></div>


<p>从上例中可以看出，新提交的进程的父 ID（PPID）为1（init 进程的 PID），并不是当前终端的进程 ID。因此并不属于当前终端的子进程，从而也就不会受到当前终端的 HUP 信号的影响了。
- 如果已经提交了任务，但是没加nohup或者setsid，怎么补救？可以用 <code>disown</code> 命令来补救。
    - <code>disown -h jobspec</code> 是某个作业忽略HUP信号
    - <code>disown -ah</code> 是所有作业忽略HUP信号
    - <code>disown -rh</code> 是正在运行的作业忽略HUP信号
- 更多技巧，参考IBM文档
1. IBM文档 <a href="https://www.ibm.com/developerworks/cn/linux/l-cn-nohup/">https://www.ibm.com/developerworks/cn/linux/l-cn-nohup/</a></p>
<h3 id="_6">字符串工具</h3>
<ul>
<li>grep 字符匹配</li>
</ul>
<div class="hlcode"><pre><span class="c">## 从log.txt中查找keyword出现的行</span>
grep keyword log.txt
<span class="c">## 查询多个模式</span>
grep -E <span class="s1">&#39;keyword|otherword&#39;</span> log.txt
grep -e keyword -e otherword log.txt
</pre></div>


<h3 id="sort">sort 命令</h3>
<p>将文件的每一行作为一个单位，进行排序，从首字符开始，按照ASCII码进行比较（默认情况）。          <br />
- u 参数，去重
- r 参数，降序
- o 参数，排序后写入原文件，重定向会将文件内容清空，达不到要求，可以用这个参数
- n 参数，表示不按照ASCII码排序，而是按照数值大小
- t 参数 和 k 参数，用来排序csv格式，t 指明分隔符 k 指明排序的列序号
- f 参数，忽略大小写
- c 参数，检查是否排好序，输出第一个乱序行信息，返回1；C参数，也是检查，但不输出乱序行信息
- M 参数，以月份排序，会识别月份（只对英文吧）
- b 参数，忽略每一行前面所有空白</p>
<h2 id="vim">VIM</h2>
<h3 id="_7">三种模式</h3>
<ul>
<li>插入模式：可以输入文本，按<code>i</code>进入</li>
<li>编辑模式：按<code>ESC</code>进入，可以移动和操纵文本</li>
<li>命令模式：可以执行冒号命令，常用的有<code>:w [filename]</code>写入文件，<code>:q</code>退出vim。</li>
</ul>
<h3 id="_8">移动光标</h3>
<p>在编辑模式下操作。</p>
<ul>
<li>基本移动：<ul>
<li>k   上</li>
<li>j   下</li>
<li>h   左</li>
<li>l   右</li>
</ul>
</li>
<li>大范围移动          <ul>
<li>ctrl + f 前进(forward)一页</li>
<li>ctrl + b 后退(back)一页</li>
</ul>
</li>
<li>更大范围移动<ul>
<li><code>*</code>和<code>#</code> 搜索当前光标所在的 <strong>单词</strong> ，跳转到下/上个地方</li>
<li><code>(</code>和<code>)</code> 移动到前/后一个 <strong>句子</strong> 的开始，以英文句号为准，对中文貌似没用，相当于段落跳转</li>
<li><code>{</code>和<code>}</code> 在 <strong>段落</strong> 间移动</li>
<li><code>fa</code> 前进到字符a，a可换成其他字符</li>
<li><code>gg</code> 文件起始位置</li>
<li><code>G</code> 最后一行起始位置</li>
<li><code>ngg</code> n行起始位置</li>
</ul>
</li>
<li>当前页跳转<ul>
<li><code>H</code> 当前页的header，<code>3H</code>当前页第3行</li>
<li><code>M</code> 当前页的middle</li>
<li><code>L</code> 当前页最后一行 ，<code>3L</code>当期那也倒数第3行</li>
</ul>
</li>
<li>行内移动<ul>
<li><code>g_</code> 行尾，空字符不算</li>
<li><code>^</code> 行首，空字符不算</li>
<li><code>$</code> 行尾</li>
<li><code>0</code> 行首</li>
<li><code>w</code> 下一个word的开头</li>
<li><code>e</code> 下一个word的结尾</li>
<li><code>b</code> 前一个word的开头</li>
</ul>
</li>
<li>搜索匹配<ul>
<li><code>/str</code>，在编辑模式下输入<code>/</code>，后面跟要搜索字符串str，然后回车搜索。</li>
<li><code>?str</code>，反向搜索字符串str</li>
<li><code>n</code>，搜索到匹配后继续向后搜索</li>
<li><code>N</code>，搜索到匹配后，继续向前搜索</li>
</ul>
</li>
</ul>
<h3 id="_9">参考</h3>
<ol>
<li><a href="http://www.jianshu.com/p/bcbe916f97e1">http://www.jianshu.com/p/bcbe916f97e1</a></li>
</ol>
</div>
<div id="content-footer">created in <span class="create-date date"> 2016-07-18 </span></div>

        </div>
        <div id="footer">
            <span>
                Copyright © 2016 tracholar.
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
                Fork me in <a href="https://github.com/tracholar/wiki" target="_blank"> github </a>.
            </span>
        </div>
        
    </body>
</html>