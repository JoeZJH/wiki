<!DOCTYPE HTML>
<html>
    <head>
        <link rel="Stylesheet" type="text/css" href="/wiki/static/css/style.css">
        <link rel="Stylesheet" type="text/css" href="/wiki/static/css/tango.css">
        <link rel="shortcut icon" href="/wiki/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/wiki/favicon.ico" type="image/x-icon">
        <title>近似最近邻搜索 - tracholar's personal knowledge wiki</title>
        <meta name="keywords" content="technology, machine learning, data mining, economics, accounting"/>
        <meta name="description" content="A wiki website of tracholar when I learned new knowledgy and technics."/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width" />

        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$(',')$'], ['\\(','\\)']]}
        });
        </script>
        <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-78529611-1', 'auto');
          ga('send', 'pageview');

        </script>
    </head>

    <body>
        <div id="container">
            
<div id="header">
  <div id="post-nav"><a href="/wiki/">Home</a>&nbsp;»&nbsp;<a href="/wiki/#machine-learning">machine-learning</a>&nbsp;»&nbsp;近似最近邻搜索</div>
</div>
<div class="clearfix"></div>
<div id="title">近似最近邻搜索</div>
<div id="content">
  <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#_1">综述</a><ul>
<li><a href="#metric-tree-spill-tree">Metric Tree， Spill Tree</a></li>
</ul>
</li>
<li><a href="#_2">大规模最近邻搜索</a><ul>
<li><a href="#partitioning-trees">partitioning trees</a></li>
</ul>
</li>
</ul>
</div>
<h2 id="_1">综述</h2>
<p>论文：An Investigation of Practical Approximate Nearest Neighbor Algorithms，Ting Liu, Andrew W. Moore, Alexander Gray and Ke Yang，2004</p>
<ul>
<li>最近邻搜索方案：<ul>
<li>Voronoi diagrams：1-2维，F. P. Preparata and M. Shamos. Computational Geometry. Springer-Verlag,</li>
<li>kd树、metric trees、ball-trees：中等维度10s<ul>
<li>J. H. Friedman, J. L. Bentley, and R. A. Finkel. An algorithm for finding best matches in loga- rithmic expected time. ACM Transactions on Mathematical Software, 3(3):209–226, September 1977.</li>
<li>J. K. Uhlmann. Satisfying general proximity/similarity queries with metric trees. Information Processing Letters, 40:175–179, 1991.</li>
<li>S. M. Omohundro. Efficient Algorithms with Neural Network Behaviour. Journal of Complex Systems, 1(2):273–347, 1987.</li>
</ul>
</li>
</ul>
</li>
<li>$(1+\epsilon)$-k最近邻搜索：返回的点最大距离不超过第k个近邻距离的 $(1+\epsilon)$ 倍！</li>
</ul>
<h3 id="metric-tree-spill-tree">Metric Tree， Spill Tree</h3>
<ol>
<li>metric tree 将样本按照二叉树结构保存，根节点代表所有的样本，它的两个子节点将样本分割成不想交的两部分；
用 v 代表节点，N(v)代表v节点的样本，左右子节点用 v.lc v.rc 表示</li>
<li>分割：对于节点v，找到两个 pivot 点 v.lpv v.rpv，使得这两个节点的距离是集合的距离，即 $(||v.lpv - v.rpv|| = \max_{p1,p2 \in N(v)} ||p1 - p2||)$，最优 pivot 寻找是二次复杂度，可以近似用线性复杂度找 pivot：<ol>
<li>先随机找一个点p</li>
<li>找到 N(v) 中距p最远的点作为 v.lpv</li>
<li>再找距v.lpv 最远的点作为 v.rpv</li>
</ol>
</li>
<li>找到两个 pivot 点后，然后将所有点点投影到这两个点的连线上 $(u = v.rpv - v.lpv)$，找到投影的中值 A 作为分割点，投影小于A的分到左子树，大于A的分到右子树；为计算效率计，可以直接用中点代替，即 $(1/2(v.rpv - v.lpv))$</li>
<li>每一个节点 v 保留 N(v) 的覆盖超球信息，球心 v.center, 半径 v.r.</li>
<li>
<p>搜索（MT-DFS）：深度优先搜索，如果待查找的q投影在A左边，先找左子树，反之先找右子树；保留k个已找到的最近邻，设这些点的距q最大距离为r；如果节点 v 的所有点距离q都大于r就可以减枝，不再找v和v的子树。可以通过条件 $(||v.center - q|| - v.r \ge r)$ 判断！</p>
</li>
<li>
<p>metric tree 的计算通过减枝减少寻找数目，但是如果无法减枝的节点，需要不断回溯，使得查找性能不高。</p>
</li>
<li>spill tree 则放弃精确查找，不回溯提高性能。但是精度将难以接受。</li>
<li>提高精度：分裂的时候两个子树可以有交集，相交部分为 $(\tao)$, overlapping buffer. 通过这种方法提高精度</li>
<li>混合搜索：$(\tao)$ 的引入带来新的问题，可能某些节点重叠部分太多，导致左右子树包含了全部数据！为此，可以设定一个阈值 $(\rho&lt;1)$（典型值70%），如果任何一个子节点包含超过这个比率的样本，则对这个节点不进行 spill分割，而进行常规的不交叠分割，并标记为 nonoverlapping 节点，其他的节点标记为overlapping节点。搜索的时候，只对 nonoverlapping 节点回溯！</li>
<li>维度超过30后，速度就会变得很慢！通过随机投影到一个低维空间后，再利用混合搜索！随机投影带来的精度损失，可以通过多次投影找回！</li>
<li><a href="https://en.wikipedia.org/wiki/Johnson%E2%80%93Lindenstrauss_lemma">Johnson-Lindenstrauss 定理</a>：W. Johnson and J. Lindenstrauss. Extensions of lipschitz maps into a hilbert space. Contemp. Math., 26:189–206, 1984.</li>
<li>LSH：A. Gionis, P. Indyk, and R. Motwani. Similarity Search in High Dimensions via Hashing. In Proc 25th VLDB Conference, 1999.</li>
</ol>
<h2 id="_2">大规模最近邻搜索</h2>
<p>Muja M, Lowe D G. Scalable nearest neighbor algorithms for high dimensional data[J]. IEEE Transactions on Pattern Analysis and Machine Intelligence, 2014, 36(11): 2227-2240.</p>
<ul>
<li>三类最近邻搜索方法：<ul>
<li>partitioning trees</li>
<li>hashing</li>
<li>neighboring graph</li>
</ul>
</li>
</ul>
<h3 id="partitioning-trees">partitioning trees</h3>
<ul>
<li>kd-tree：低维空间高效，但是维度高了效果急剧下降！</li>
<li>多个 randomized k-d trees</li>
</ul>
</div>
<div id="content-footer">created in <span class="create-date date"> 2017-04-10 </span></div>
<div id="comments"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script type="text/javascript">
const gitment = new Gitment({
  title: '近似最近邻搜索',
  owner: 'tracholar',
  repo: 'wiki',
  oauth: {
    client_id: '0cc0476e504b5e70ae7c',
    client_secret: 'ab98e39ef79469040057eba9c6b2b543b84c72ee',
  },
  // ...
  // For more available options, check out the documentation below
})

gitment.render('comments')
// or
// gitment.render(document.getElementById('comments'))
// or
// document.body.appendChild(gitment.render())
</script>

        </div>
        <div id="footer">
            <span>
                Copyright © 2017 tracholar.
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
                Fork me in <a href="https://github.com/tracholar/wiki" target="_blank"> github </a>.
            </span>
        </div>
        

        <script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?df74779713027375e7b79302fb72d7b0";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
        </script>

    </body>
</html>