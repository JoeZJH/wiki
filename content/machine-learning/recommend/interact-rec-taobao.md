---
title: "淘宝交互式推荐"
layout: page
date: 2020-03-05
---

[TOC]

# 关于
- 参考<https://mp.weixin.qq.com/s/oY9BBjAHUKZr6dVdnNtcbg>
- 论文：
    - Query-based Interactive Recommendation by Meta-Path and Adapted Attention-GRU <https://arxiv.org/pdf/1907.01639.pdf>
    - A Two-Stage Approach toward InteractiveRecommendation


# FAQ
## 交互式推荐跟普通的推荐根本区别是什么
- 普通的推荐用户交互成本低但意图较弱，搜索意图强但是用户交互成本高
- 交互是推荐将搜索和推荐的两个优势结合了起来
    - 先推荐一些关键词，用低交互成本将用户意图明确
    - 然后变成关键词搜索问题，用明确意图来提高后续转化

## 交互式推荐的本质是什么
- 通过跟用户交互，用**低成本**的方式**将用户的意图明确出来**，然后进行推荐

## 什么时候出这个关键词
猜你喜欢页面点击一个商品  -> 详情页动作 -> 返回猜你喜欢 -> 出关键词（算法控制出不出）

## 为什么要在这个时刻出？其他时刻可不可以？
- 因为用户跟一个商品交互后，相当于给系统注入了新的重要信息。这个信息才是整个系统提升的根本来源。传统的推荐系统在下一频才能利用到这个信息，而交互式推荐可以立马使用上这个信息。
- 其他时刻可能可以，也需要用户有一个明确的动作告诉系统，他当时的意图。从目前产品研究来看，几乎所有的APP都是这样，视频feed则是通过播放动作来触发。


## 关键词是如何召回
- 根据用户刚点击过的item作为触发源
- i2q，从大搜的日志中，提取query跟点击过的item的共现关系，构造i2q的映射
$$
P(q|i) = \frac{Count(q, i)}{Count(i)}
$$
- i2scene2q，先将item映射到场景，然后通过场景映射到query
- i2c2q，将item映射到类目，然后映射到query

## 场景有哪些？如何跟item和query关联的？

## 不同路径召回的得分是如何融合的
- 对每个q，计算所有召回路径的概率之和。路径概率利用马尔科夫性假设


## 关键词如何排序
- 以点击做监督信号
- 线性模型 FTRL 和 DNN（用Attention_GRU建模用户长期兴趣）

![排序模型](/wiki/static/images/interact-rec-01.webp)


## 为什么模型对用户长期行为建模时不是用ID序列，而是用item的特征
- 目测是因为数据偏少，所以直接学embedding向量太难了。所以使用了item的特征

## 模型用到的特征有哪些
- item的特征有：
    - 文本特征：标题分词后词向量均值，i2q的query词向量均值
    - 统计特征
    - 一级品类embedding
    - 品牌embedding
    - 行为类型embedding，在用户表达中有，行为类型就是指用户是买过、点过还是收藏etc
- 用户侧特征
    - 非实时特征
        - id embedding
        - Attention_GRU对行为序列Encode
    - 实时特征
        - 详情页的行为特征
- query测特征
    - 文本特征：分词后词向量均值
    - 统计特征
    - 3个类目的embedding均值
- 其他特征
    - metapath类型和得分

## 文中所的对AttentionGRU做干预是如何做的
- 正常的方式是将每个item的隐向量直接跟query向量计算权重，然后将所有item向量家权和，得到新的隐向量
- 文中的做法是对计算出来的权重乘以时间衰减常数，和乘以行为类型矩阵

## 排序后的重排做了啥
- 只做多样性控制，具体如何控制没说
- 个人猜测，应该是计算文本的某种相似度，限定相似度不能太大

## 展现控制模块都做了啥
- 控制出不出：通过用户意图预测，判断出不出
- 将词变成场景文本
- 行业干预：如双十一的人工策略干预

## 控制出不出的意图预测是如何做的
- 没有说

## 如何评估加入风向标和不加的效果差异
- 直接根据AB测试，看业务指标即可
- 点击率怎么看？应该只能看总体的交易额？

![线上效果](/wiki/static/images/interact-rec05.png)


## 关键词是如何变成场景文本的？
- 文中没有说
