---
title: "第03.0讲：机器学习建模实战"
layout: page
date: 2018-02-06
---
[TOC]

## 关于
本讲内容将通过一个例子，深入理解机器学习建模的整个过程。在这一讲中，你将学习到：

1. 什么是过拟合与泛化？为什么要划分训练集、测试集、验证集。
2. 什么是交叉验证？
3. 如何评估一个分类模型的好坏？
4. 方差-偏差分解
5. 决策树的减枝与泛化

学习本讲，希望你

1. 至少有高中数学水平。
2. 了解决策树，如果还不了解，可以参看[决策树模型](/wiki/tutorial/ml/intro-dt.html)
2. 如果你需要完成实践部分，需要有基本的 python 知识，你可以通过[python快速入门](/wiki/tutorial/ml/intro-python.html)快速了解python如何使用。

本讲所用的数据集还是采用鸢尾花(iris)数据集，你可以从UCI网站上下载<https://archive.ics.uci.edu/ml/datasets/Iris>。如果已经安装了 scikit-learn，那么可以利用提供的dataset接口直接调用。鸢尾花数据集是著名的统计学家 Fisher 提供的。下面我们采样少量的数据看一看。

|   | sepal length (cm) | sepal width (cm) | petal length (cm) | petal width (cm) | target  
|---|---|---|---|---|---  
91 | 6.1 | 3.0 | 4.6 | 1.4 | 1  
77 | 6.7 | 3.0 | 5.0 | 1.7 | 1  
99 | 5.7 | 2.8 | 4.1 | 1.3 | 1  
65 | 6.7 | 3.1 | 4.4 | 1.4 | 1  
14 | 5.8 | 4.0 | 1.2 | 0.2 | 0  
108 | 6.7 | 2.5 | 5.8 | 1.8 | 2  
142 | 5.8 | 2.7 | 5.1 | 1.9 | 2  
127 | 6.1 | 3.0 | 4.9 | 1.8 | 2  
24 | 4.8 | 3.4 | 1.9 | 0.2 | 0  
2 | 4.7 | 3.2 | 1.3 | 0.2 | 0


该数据集的每一条记录代表一个样本，每一个样本有4个属性变量：

- sepal length (cm) 萼片长度
- sepal width (cm) 萼片宽度
- petal length (cm) 花瓣长度
- petal width (cm) 花瓣宽度

每一个样本有1个目标变量target，target有3个取值，每一种取值的意义如下：

- 0： setosa 山鸢尾
- 1： versicolor 变色鸢尾
- 2： virginica 维吉尼亚鸢尾

这个数据集一共有150个样本，这三种花都有50个样本。上面显示出来的只是随机选取的一部分数据。每一种鸢尾花的图片如下，从左到右分别是 setosa,versicolor,virginica

![Iris](/wiki/static/images/iris.png)

## 分类准确率
在上一讲中，我们说到决策树生成算法，每一步都是穷举所有可能的分裂规则，利用信息增益准则找到最佳规则，将最佳规则加入决策树中，持续这个步骤知道满足停止准则。在前面，我们介绍了三个停止准则，分别是：如果集合中只有一类样本，就停止分裂；如果集合中样本个数少于某个阈值，就停止分裂；如果树的深度达到某个阈值，就停止分裂。显然，如果停止准则不同，那么我们得到的决策树也不同，这么多决策树如何评估哪一个好，哪一个不好呢？
