---
title: "Hive中窗函数的妙用"
layout: page
date: 2017-11-30
---
[TOC]

## 问题背景
先有表如下

-------------------
| A  |   B  |  C  |
|----|------|-----|
| 1  |   5  |  abc |
| 7  |   4  | abc   |
| 5  |   6  |  abc  |
--------------------

现在需要对同一个C，按照A列排序（倒序），计算B的累积分布。
例如，在这个例子中，C=abc，A=7，累积值 CB=4; A=5, 累计值 CB=4+6=10； A=1, 累积值CB=4+6+5=15； 
